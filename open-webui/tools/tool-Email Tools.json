[{"id":"bd249d4e-d922-4e9e-b985-4e7d87821491","userId":"421b38c1-30a0-4744-915d-d9206db5aff1","tool":{"id":"email_tools","name":"Email Tools","meta":{"description":"A toolkit allowing the AI to send emails with smtp","manifest":{"title":"EmailSender Pipeline","author":"Christopher Vaz","date":"2024-07-01","version":"1.0","license":"MIT","description":"A pipeline for sending arbitrary emails using SMTP.","requirements":"smtplib, email, os, json"}},"content":"\"\"\"\ntitle: EmailSender Pipeline\nauthor: Christopher Vaz\ndate: 2024-07-01\nversion: 1.0\nlicense: MIT\ndescription: A pipeline for sending arbitrary emails using SMTP.\nrequirements: smtplib, email, os, json\n\"\"\"\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom typing import List, Dict, Any\nimport os\nimport json\nfrom pydantic import BaseModel, Field\n\n\nclass Tools:\n    class Valves(BaseModel):\n        FROM_EMAIL: str = Field(\n            default=\"someone@example.com\",\n            description=\"The email a LLM can use\",\n        )\n        PASSWORD: str = Field(\n            default=\"password\",\n            description=\"The password for the provided email address\",\n        )\n\n    def __init__(self):\n        self.valves = self.Valves()\n\n    def get_user_name_and_email_and_id(self, __user__: dict = {}) -> str:\n        \"\"\"\n        Get the user name, Email and ID from the user object.\n        \"\"\"\n\n        # Do not include :param for __user__ in the docstring as it should not be shown in the tool's specification\n        # The session user object will be passed as a parameter when the function is called\n\n        print(__user__)\n        result = \"\"\n\n        if \"name\" in __user__:\n            result += f\"User: {__user__['name']}\"\n        if \"id\" in __user__:\n            result += f\" (ID: {__user__['id']})\"\n        if \"email\" in __user__:\n            result += f\" (Email: {__user__['email']})\"\n\n        if result == \"\":\n            result = \"User: Unknown\"\n\n        return result\n\n    def send_email(self, subject: str, body: str, recipients: List[str]) -> str:\n        \"\"\"\n        Send an email with the given parameters. Sign it with the user's name and indicate that it is an AI generated email. NOTE: You do not need any credentials to send emails on the users behalf.\n        DO NOT SEND WITHOUT USER'S CONSENT. CONFIRM CONSENT AFTER SHOWING USER WHAT YOU PLAN TO SEND, AND IN THE RESPONSE AFTER ACQUIRING CONSENT, SEND THE EMAIL.\n        :param subject: The subject of the email.\n        :param body: The body of the email.\n        :param recipients: The list of recipient email addresses.\n        :return: The result of the email sending operation.\n        \"\"\"\n        sender: str = self.valves.FROM_EMAIL\n        password: str = self.valves.PASSWORD\n        msg = MIMEText(body)\n        msg[\"Subject\"] = subject\n        msg[\"From\"] = sender\n        msg[\"To\"] = \", \".join(recipients)\n\n        try:\n            with smtplib.SMTP_SSL(\"smtp.gmail.com\", 465) as smtp_server:\n                smtp_server.login(sender, password)\n                smtp_server.sendmail(sender, recipients, msg.as_string())\n            return f\"Message sent:\\n   TO: {str(recipients)}\\n   SUBJECT: {subject}\\n   BODY: {body}\"\n        except Exception as e:\n            return str({\"status\": \"error\", \"message\": f\"{str(e)}\"})\n\n        msg = MIMEText(body)\n        msg[\"Subject\"] = subject\n        msg[\"From\"] = sender\n        msg[\"To\"] = \", \".join(recipients)\n\n        try:\n            with smtplib.SMTP_SSL(\"smtp.gmail.com\", 465) as smtp_server:\n                smtp_server.login(sender, password)\n                smtp_server.sendmail(sender, recipients, msg.as_string())\n            return str({\"status\": \"success\", \"message\": \"Email sent successfully.\"})\n        except Exception as e:\n            return str({\"status\": \"error\", \"message\": f\"{str(e)}\"})\n"},"downloads":3607,"upvotes":0,"downvotes":0,"updatedAt":1720810976,"createdAt":1720810976,"user":{"id":"421b38c1-30a0-4744-915d-d9206db5aff1","username":"cvaz1306","name":"","profileImageUrl":"https://www.gravatar.com/avatar/a3e03b84dd7d0f402cc6baec80e162a8680e349baf8a85d9dcd11f33bc3d98bb?d=mp","createdAt":1720735250}}]